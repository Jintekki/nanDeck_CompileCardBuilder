# nanDeck Compile Card Builder
## Purpose
This is a script and accomponying files used by the nanDeck program to create homebrew protocols and command cards for the card game Compile designed by [Michael Yang](https://boardgamegeek.com/boardgamedesigner/158096/michael-yang).
## Contents
### <ins>-Main Folder-
+ **nanDeck_Compile.txt** : The core script that builds the cards.
+ **ImageSlice.txt** : A subscript used by nanDeck_Compile.txt to slice images into smaller images for the cards backgrounds.


### <ins>-Main Folder//Universal Assets-</ins>
A multitude of images used by the script to build each card. These images are shared between all cards.


### <ins>-Main Folder//NEW_PROTOCOL-</ins>
This is an example for how the file structure should be set up.

+ **Compile.xslx** : The spreadsheet file containing the information for each card. Please ensure that the <ins>filename does not change</ins> and that it is placed at the upmost folder as it works as the root for the programs execution to find the other custom files for the protocol (ie not the universal assets).


#### <ins>-Main Folder//NEW_PROTOCOL//Assets-</ins>
Contains the custom image files used for building the cards backgrounds and protocol icon. The file names must match what is given or the program will not be able to find the files.

+ **CommandBackground.jpg** : Roughly 4:5 image that is sliced by the program to be used as the background for the command cards.
+ **ProtocolBackground.jpg** : Roughly 7:5 image that is sliced by the program to be used as the front and back of the protocol card. 
The loading side is the left, the compiled side is the right. This image is rotated 90 degrees clockwise to properly position the image to the sideways card.
+ **icon.png** : The protocols icon image.


#### <ins>-Main Folder//NEW_PROTOCOL//Resources-</ins>
_This folder is not necessary._

Contains the original images before they have been croped down to the proper aspect ratio. These are here for example purposes and may be removed by the user if desired.


#### <ins>-Main Folder//NEW_PROTOCOL//TEMP-</ins>
-This folder is not necessary.-

Contains the sliced images of the backgrounds in the NEW_PROTOCOL//Assets folder.
This folder may be deleted after the cards are generated or otherwise kept to speed up the building process (as these images can be directly referenced rather than resliced).


#### <ins>-Main Folder//NEW_PROTOCOL//Generated-</ins>
This is the output folder that is generated by the program.
Contains the 2 output file types.

+ **3x3 Sheet** : Contains all 8 cards and a white space at the top right. This format is intended for sharing on the Compile Discord. The white space is for adding flavor text in an alternate software (GIMP).
+ **3x2 Sheet / 2x single cards** : This format is used for importing into Tabletop Simulator



## How do I use the script?
1. Download [nanDeck](https://nandeck.com/old-versions) if you have not already. It is free to download and use.
2. Fill out the **Compile.xlsx** [spreadsheet](Main/NEW_PROTOCOL/Compile.xlsx) with information about the cards and protocol. Click [here](#Spreadsheet) for information about the spreadsheet.
3. Once the spreadsheet is filled out, download it and place it at the root of the protocols folder. This file will be used to source the images used for the icon and background. **Ensure the name and extension match what is shown in the [example](Main/NEW_PROTOCOL) or the program will not work as intended.**
4. Source images
  - Create or download images for the protocol and command cards backgrounds. These images will be sliced by the program.
  - For the Command Cards Background:
    - Cut image to an aspect ratio close to 4:5 or the image will be warped. Higher resolutions look nicer but are not necessary.
    - **Ensure image name is CommandBackground.jpg and is placed in the [Assets](Main/NEW_PROTOCOL/Assets) folder!**
  
  Example Image:
  
  ![CommandBackground](Main/NEW_PROTOCOL/Assets/CommandBackground.jpg)

  - For the Protocol Cards Background:
    - Cut image to an aspect ratio close to 7:5 or the image will be warped. Higher resolutions look nicer but are not necessary.
    - Rotate the final image 90 degrees clockwise. The protocol cards are sideways and the image will not be correct if not rotated.
    - The loading side is the left and the compiled side is the right
    - **Ensure image name is ProtocolBackground.jpg and is placed in the [Assets](Main/NEW_PROTOCOL/Assets) folder!** 

  Example Image:
  
  ![ProtocolBackground](Main/NEW_PROTOCOL/Assets/ProtocolBackground.jpg)

5. Open nanDeck and Generate Cards:
  - Step 1 - Press the "Open Deck" button near the top of the left menu.

<img width="1919" height="1079" alt="11" src="https://github.com/user-attachments/assets/a6d50db9-6cec-408b-a3a6-ad3a1d2566bf" />



  - Step 2 - Navigate to where you have downloaded the Main folder and open the nanDeck_Compile.txt file.

<img width="1919" height="1079" alt="21" src="https://github.com/user-attachments/assets/53484755-33ed-4d7c-80b8-46cf9de1638c" />



  - Step 3 - Press the Validate Deck button on the left bar. The boolean values in the green box may be altered to change what file formats get generated.

<img width="1919" height="1079" alt="31" src="https://github.com/user-attachments/assets/66d1008d-9ca6-4dcf-aedf-b27e1118c5fa" />



  - Step 4 - Press the Browse... button.

<img width="1919" height="1079" alt="41" src="https://github.com/user-attachments/assets/b1f85729-f15e-4124-bc29-b30419d47f66" />



  - Step 5 - Navigate to the Protocol folder and open the Compile.xlsx file.

<img width="1919" height="1079" alt="51" src="https://github.com/user-attachments/assets/a627d48b-40d9-4f38-aed9-eb9d87221a03" />



  - Step 6 - Press the Confirm + Build button and wait. If all file names, file extensions, and file locations are correct the program will run as expected.

<img width="1919" height="1079" alt="61" src="https://github.com/user-attachments/assets/13f7b53e-c596-4f37-be2c-7176c8e1b86a" />



  - Step 7 - Your deck will be built and files generated (if any). Press the Card Preview button in the green box to preview the cards.

<img width="1919" height="1079" alt="71" src="https://github.com/user-attachments/assets/e36e9f25-55e1-4536-b739-f13a19a04373" />



    - Step 7a (Optional) Preview cards.

<img width="1919" height="1076" alt="81" src="https://github.com/user-attachments/assets/1b41fff5-d5e3-44b4-ae82-53ac0ca027bd" />



  - Step 8 - Any generated files will be in the new [Generated](Main/NEW_PROTOCOL/Generated) folder located next to the Compile.xlsx file. The generation path values may be changed inside the script.

<img width="679" height="277" alt="91" src="https://github.com/user-attachments/assets/aa6bc394-5fd1-42ec-9d75-240a213593cc" />



  - Step 9 - Import to TTS, Share, Enjoy.


## Spreadsheet
The [spreadsheet](Main/NEW_PROTOCOL/Compile.xlsx) contains two subsheets, one for the Protocol and one for the Command Cards - **both are necessary**.

You may save the file under any name, but the program **requires a name of Compile.xlsx to function.**

*Do not change column headers or the program will not function*

### Protocol
- **Protocol Name** - Name of the protocol. IE Water
- **Protocol Description** - Flavor text for the protocol. IE >Wash away and renew.
- **Protocol Actions** - Short keyword description for what the protocol focuses on. IE Return, draw, flip
- **Creator Tag** - Person who designed the protocol. - IE M. Yang, NZ3R0K
    - *NOTE that the Creator Tag must be short, long names will be cut off.*

### Command
- **Version** - Tracker for changes made to an individual card. Start at v0.1. Not necessary but an option nonetheless.
- **Card Name** - Flavor text and general descriptor for the card. Way for people to differentiate between cards of the same value in a single protocol.
- **Value** - What the cards value will be when placed face-up on the field.
- **Persistent Emphasis** - Top commands bolded text.
- **Persistent Text** - Top command default text.
- **Immediate Emphasis** - Middle commands bolded text.
- **Immediate Text** - Middle command default text.
- **Auxiliary Emphasis** - Bottom command bolded text.
- **Auxiliary Text** - Bottom command default text.


Here is what the spreadsheet looks like in Google Sheets:

Protocol Sheet:

<img width="527" height="50" alt="Screenshot 2025-08-09 135450" src="https://github.com/user-attachments/assets/1c87907c-49fa-492a-8698-b4079f6991ab" />


Command Sheet:

<img width="1267" height="141" alt="10" src="https://github.com/user-attachments/assets/d8c1109d-f954-4778-81b2-82e78723fbfe" />
